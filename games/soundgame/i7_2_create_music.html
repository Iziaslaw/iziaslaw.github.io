<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
<!--
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0 , user-scalable=no, maximum-scale=1.0">
-->
<!--    <meta name="viewport" content="width=device-width,user-scalable=no" />-->
    <title>Piano izi rocket</title>
    
    <script type="text/javascript" src="bib/phaser.2.7.10.js"></script>
    
</head>
<body>
    
<div id="example">
<script type="text/javascript">
var game = new Phaser.Game(1280, 720, Phaser.CANVAS, 'example', { preload: preload, create: create, update: update});
    
var background;
var button,button1,button2,button3,button4,button5,button6,button7,button8,button9,button10,button11,button12,button13,button14,button15,button16,button17,button18;

var flag = true;    
var emitter, rocket; 
var srain;    

    var c,c1,c2,c3,c4,c5,c6;
    var ee = false;
    var h,ha,x,y;
    var cc1,cc2,cc3,cc4,cx2,cx4,cy2,cy3,cy4,c1sx,c1sy,c2sx,c2sy,c4sy,c6sx,c6sy,c2ang,c4ang;
    
function preload() {
    game.load.spritesheet('buttonB', 'image/music/piano_keys_black.png', 26, 30);
    game.load.spritesheet('buttonC', 'image/music/piano_keys_color.png',28,60 );
    game.load.audio('piano', 'audio/piano_c3-c5.ogg');
    
//    game.load.spritesheet('face', 'image/char_1/face_2_128_128.png', 128, 128);
//    game.load.spritesheet('eyeb', 'image/char_1/eyebrow_2_32_12.png', 32, 12);
//    game.load.spritesheet('eye', 'image/char_1/eye_2_32_32.png', 32, 32);
//    game.load.spritesheet('mouth', 'image/char_1/mouth_2_36_26.png', 36, 26);
    game.load.spritesheet('pokemons', 'image/pokemons_493.png', 71, 70);//493
    
}
    
function create() {
    
    game.world.setBounds(0, 0, 1280, 480);

    game.physics.arcade.gravity.y = 100;
    
    button1 = game.add.button(20, 480, 'buttonC', null, this, 16, 17, 15);
    button1.name = 'a3';
    button1.scale.setTo(4, 4);
    button1.events.onInputDown.add(music);
    //button1.anchor.setTo(0.5, 0.5);
    //button2.angle = 24;
    //button3.width = 300;

    button2 = game.add.button(button1.x + 112, button1.y, 'buttonC', null, this, 19, 20, 18);
    button2.name = 'b3';
    button2.scale.setTo(4, 4);
    button2.events.onInputDown.add(music);    
    
    button3 = game.add.button(button1.x + 112*2, button1.y, 'buttonC', null, this, 1, 2, 0);
    button3.name = 'c4';
    button3.scale.setTo(4, 4);
    //button3.events.onInputOver.add(music);
    //button3.events.onInputOut.add(music);
    button3.events.onInputDown.add(music);
    //button3.events.onInputUp.add(function(){pianoAll.stop(batton.name)});
    
    button4 = game.add.button(button1.x + 112*3, button1.y, 'buttonC', null, this, 4, 5, 3);
    button4.name = 'd4';
    button4.scale.setTo(4, 4);
    //button4.addKey(Phaser.Keyboard.W);
    button4.events.onInputDown.add(music);
    
    button5 = game.add.button(button1.x + 112*4, button1.y, 'buttonC', null, this, 7, 8, 6);
    button5.name = 'e4';
    button5.scale.setTo(4, 4);
    button5.events.onInputDown.add(music);
    
    button6 = game.add.button(button1.x + 112*5, button1.y, 'buttonC', null, this, 10, 11, 9);
    button6.name = 'f4';
    button6.scale.setTo(4, 4);
    button6.events.onInputDown.add(music);
    
    button7 = game.add.button(button1.x + 112*6, button1.y, 'buttonC', null, this, 13, 14, 12);
    button7.name = 'g4';
    button7.scale.setTo(4, 4);
    button7.events.onInputDown.add(music);
    
    button8 = game.add.button(button1.x + 112*7, button1.y, 'buttonC', null, this, 16, 17, 15);
    button8.name = 'a4';
    button8.scale.setTo(4, 4);
    button8.events.onInputDown.add(music);
    
    button9 = game.add.button(button1.x + 112*8, button1.y, 'buttonC', null, this, 19, 20, 18);
    button9.name = 'b4';
    button9.scale.setTo(4, 4);
    button9.events.onInputDown.add(music);
    
    button10 = game.add.button(button1.x + 112*9, button1.y, 'buttonC', null, this, 1, 2, 0);
    button10.name = 'c5';
    button10.scale.setTo(4, 4);
    button10.events.onInputDown.add(music);
    
    button11 = game.add.button(button1.x + 112*10, button1.y, 'buttonC', null, this, 4, 5, 3);
    button11.name = 'd5';
    button11.scale.setTo(4, 4);
    button11.events.onInputDown.add(music);
    
    button12 = game.add.button(button1.x + 60, button1.y, 'buttonB', null, this, 0, 1, 2);
    button12.name = 'a#3';
    button12.scale.setTo(4, 4);
    button12.events.onInputDown.add(music1);
    
    button13 = game.add.button(button1.x + 60 + 112 *2, button1.y, 'buttonB', null, this, 0, 1, 2);
    button13.name = 'c#4';
    button13.scale.setTo(4, 4);
    button13.events.onInputDown.add(music1);
    
    button14 = game.add.button(button1.x + 60 + 112 * 3, button1.y, 'buttonB', null, this, 0, 1, 2);
    button14.name = 'd#4';
    button14.scale.setTo(4, 4);
    button14.events.onInputDown.add(music1);
    
    button15 = game.add.button(button1.x + 60 + 112 *5, button1.y, 'buttonB', null, this, 0, 1, 2);
    button15.name = 'f#4';
    button15.scale.setTo(4, 4);
    button15.events.onInputDown.add(music1);
    
    button16 = game.add.button(button1.x + 60 + 112 *6, button1.y, 'buttonB', null, this, 0, 1, 2);
    button16.name = 'g#4';
    button16.scale.setTo(4, 4);
    button16.events.onInputDown.add(music1);
    
    button17 = game.add.button(button1.x + 60 + 112 *7, button1.y, 'buttonB', null, this, 0, 1, 2);
    button17.name = 'a#4';
    button17.scale.setTo(4, 4);
    button17.events.onInputDown.add(music1);
    
    button18 = game.add.button(button1.x + 60 + 112 * 9, button1.y, 'buttonB', null, this, 0, 1, 2);
    button18.name = 'c#5';
    button18.scale.setTo(4, 4);
    button18.events.onInputDown.add(music1);
    //text buttons
    var tb1 = game.add.text(button3.x + 50, button1.y + 180, "C", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb2 = game.add.text(button4.x + 50, button1.y + 180, "D", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb3 = game.add.text(button5.x + 50, button1.y + 180, "E", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb4 = game.add.text(button6.x + 50, button1.y + 180, "F", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb5 = game.add.text(button7.x + 50, button1.y + 180, "G", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb6 = game.add.text(button8.x + 50, button1.y + 180, "A", { font: "15px Arial", fill: "#79646a", align: "center" });
    var tb7 = game.add.text(button9.x + 50, button1.y + 180, "B", { font: "15px Arial", fill: "#79646a", align: "center" });
    
    pianoAll = game.add.audio('piano');
    pianoAll.allowMultiple = true;
    

//    pianoAll.addMarker('c301', 0, 0.9);
//    pianoAll.addMarker('c302', 1, 0.9);
//    pianoAll.addMarker('c303', 2, 0.9);
//    pianoAll.addMarker('c304', 3, 0.9);
//    pianoAll.addMarker('c305', 4, 0.9);
//    pianoAll.addMarker('c306', 5, 0.9);
//    pianoAll.addMarker('c307', 6, 0.9);
//    pianoAll.addMarker('c308', 7, 0.9);
//    pianoAll.addMarker('c309', 8, 0.9);
    pianoAll.addMarker('a3', 9, 0.9);
    pianoAll.addMarker('a#3', 10, 0.9);
    pianoAll.addMarker('b3', 11, 0.9);
    pianoAll.addMarker('c4', 12, 0.9);
    pianoAll.addMarker('c#4', 13, 0.9);
    pianoAll.addMarker('d4', 14, 0.9);
    pianoAll.addMarker('d#4', 15, 0.9);
    pianoAll.addMarker('e4', 16, 0.9);
    pianoAll.addMarker('f4', 17, 0.9);
    pianoAll.addMarker('f#4', 18, 0.9);
    pianoAll.addMarker('g4', 19, 0.9);
    pianoAll.addMarker('g#4', 20, 0.9);
    pianoAll.addMarker('a4', 21, 0.9);
    pianoAll.addMarker('a#4', 22, 0.9);
    pianoAll.addMarker('b4', 23, 0.9);
    pianoAll.addMarker('c5', 24, 0.9);
    pianoAll.addMarker('c#5', 25, 0.9);
    pianoAll.addMarker('d5', 26, 0.9);
//    pianoAll.addMarker('c504', 27, 0.9);
//    pianoAll.addMarker('c505', 28, 0.9);
//    pianoAll.addMarker('c506', 29, 0.9);
//    pianoAll.addMarker('c507', 30, 0.9);
//    pianoAll.addMarker('c508', 31, 0.9);
//    pianoAll.addMarker('c509', 32, 0.9);
//    pianoAll.addMarker('c510', 33, 0.9);
//    pianoAll.addMarker('c511', 34, 0.9);
//    pianoAll.addMarker('c512', 35, 0.9);
    
    cursors = game.input.keyboard.createCursorKeys();
    //button.events.onInputDown.add(music, this);
    //game.input.onDown.add();
}    
    
    
function music(button) {
    pianoAll.play(button.name);
   
       
emitter = game.add.emitter(button.x + 60, 400, 2);//250

    emitter.makeParticles('pokemons', [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492], 15, true, true);//200 строка или массив спрайтов, номер кадра или массив, кол-во создаваемых частиц, отскоки от других частиц, отскоки от границ мира

    emitter.minParticleSpeed.setTo(-200, -300);
    emitter.maxParticleSpeed.setTo(200, -400);
    emitter.gravity = 150;
    emitter.bounce.setTo(0.5, 0.5);
    emitter.angularDrag = 30;
    
game.physics.enable(emitter, Phaser.Physics.ARCADE);
    emitter.start(true, 3500,null, 1);
    //emitter.start(false, 8000, 500);//частицы лопнут одновременно или нет, сколько живет каждая частица мс, как часто выдаёт 1 частицу мс, сколько выдаёт частиц 0=все, если true то выдаёт один раз кол-во  частиц которое указано и больше не выдаёт
    
    
        
        ee = true;
    
     
    }
    function music1(button) {
        
        rocket = game.add.emitter(button.x + 60, 400, 2);
        rocket.makeParticles('buttonB', [0,1,2], 15, true, true);
        rocket.minParticleSpeed.setTo(0, -300);
        rocket.maxParticleSpeed.setTo(0, -400);
        rocket.minParticleScale.y = 3.0;
        rocket.maxParticleScale.y = 3.0;
        rocket.bounce.setTo(0.5, 0.5);
        rocket.gravity = 0;
        
        game.physics.enable(rocket, Phaser.Physics.ARCADE);
        
        rocket.start(true, 3500,null, 1);
    }
    
    function update() {
        
        
        if(ee) {
        game.physics.arcade.collide(emitter);
        //c1.y = 1;
            
                game.physics.arcade.collide(rocket, emitter);
                game.physics.arcade.overlap(rocket, emitter, collision, null, this);

        }
        
    if (game.input.keyboard.isDown(Phaser.Keyboard.Q)) {
        //music('c4');
    }
    if (game.input.keyboard.isDown(Phaser.Keyboard.R)) {
        
    }
    if (game.input.keyboard.isDown(Phaser.Keyboard.W)) {
        
    }
    if (game.input.keyboard.isDown(Phaser.Keyboard.E)) {
        
    }    
    }
    function collision(roc, emi) {
        
        
    }
    
    
</script></div>

</body>
</html>