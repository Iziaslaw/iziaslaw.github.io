<html>

<head>
  <title>ex_p5_sound_jump</title>
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
-->
  <script type="text/javascript" src="https://iziaslaw.github.io/lib/p5.min.js"></script>
  <script type="text/javascript" src="https://iziaslaw.github.io/lib/p5.dom.min.js"></script>
  <script type="text/javascript" src="https://iziaslaw.github.io/lib/p5.sound.min.js"></script>

  <!--    <script type="text/javascript" src="js/main.js"></script>-->
<style>
  body {
    background: #aabbcc;
    margin: 20px;
    padding: 0;
  }
</style>

</head>
<body>
  
  <div>

<script>
  var slider, slider2,button;
  var star;
  var stars = [];
  var env,wave;
  var timer = 0;
  var millisecond;
  var iN = 0;
  var freqPlayer1 = [69,72,76,78,76,72,71,80,83,80,78,76,74,76,71];//75,76,77,77,80,80,83,
  var lenNotePlayer1 = [125,125,500,125,250,125,250,500,125,125,125,125,125,250,1000];//1000,125,125,500,500,250,1000,
  var freqNote,lengthNote;
  var playing = true;
  function setup() {
    createCanvas(innerWidth, innerHeight * 0.9);
    //stars();
    //angleMode(DEGREES);
    slider = createSlider(0.0001, 1.5001, 0.0001, 0.001);
    slider2 = createSlider(0.01, 0.80, 0.05, 0.01);
    
  for (var i = 0; i < 350; i++) {
      let x = random(0, width );
      let y = random(0, height );
      stars[i] = new Star(x, y, random(1,3));
    }
    
    button = createButton('music');
    button.mousePressed(toggleStop);
    env = new p5.Env();
    env.setADSR(0.005, 0.5, 0.1, 0.5);
    env.setRange(0.2, 0);
    
    wave = new p5.Oscillator();
    wave.setType('sine');//sine triangle square sawtooth
    wave.start();
    //wave.freq(440);
    wave.amp(env);
  }
  function toggleStop() {
    if(playing) {playing = false;}else {playing = true;}
  }
  function Star(x,y,r) { 
    this.pos = createVector(x,y);
    this.r = r;
    
    this.show = function() {
      fill(245,245,245,50);
      noStroke();
      ellipse(this.pos.x, this.pos.y, this.r, this.r);
    }
  }
  //sun 109 r earth
  let angle2 = 1.5;//r 2439.7 km, a 57 909 227 km, p 87,969 d
  let angle3 = 1.5;//r 6051.8 km, a 108 208 930 km, p 224,698 d
  let angle4 = 1.5;//r 6371.0 km, a 149 598 261 km, p 365,256 d
  let angle5 = 1.5;//r 3389.5 km, a 227 943 820 km, p 686,98 d
  let angle6 = 1.5;//r 69911 km, a 778 547 200 km, p 4332,589 d
  let angle7 = 1.5;//r 58232 km, a ~1 433 449 369 km, p 10759,22 d ,125k
  let angle8 = 1.5;//r 25362 km, a 2 876 679 082 km, p 30685,4 d
  let angle9 = 1.5;//r 24622 km, a 4 503 443 661 km, p 60190,03 d
  let angle10 = 1.5;//r 1187 km, a 39.482117 ae, p 90553,02 d

  
  function draw() {
    background(0);
    for (var i = 0; i < stars.length; i++) {
      stars[i].show();
    }
    
    angle2 = angle2 + 1.1    * slider2.value();//(10000 / 88);
    angle3 = angle3 + 0.44   * slider2.value();//(10000 / 224);
    angle4 = angle4 + 0.27   * slider2.value();//(10000 / 365);
    angle5 = angle5 + 0.14   * slider2.value();//(10000 / 687);
    angle6 = angle6 + 0.023  * slider2.value();//(10000 / 4332);
    angle7 = angle7 + 0.009  * slider2.value();//(10000 / 10759);
    angle8 = angle8 + 0.003  * slider2.value();//(10000 / 30685);
    angle9 = angle9 + 0.0016 * slider2.value();//(10000 / 60190);
    var x2 = Math.sin(angle2) * 6;
    var y2 = Math.cos(angle2) * 6;
    var x3 = Math.sin(angle3) * 11;
    var y3 = Math.cos(angle3) * 11;
    var x4 = Math.sin(angle4) * 15;
    var y4 = Math.cos(angle4) * 15;
    var x5 = Math.sin(angle5) * 23;
    var y5 = Math.cos(angle5) * 23;
    var x6 = Math.sin(angle6) * 78;
    var y6 = Math.cos(angle6) * 78;
    var x7 = Math.sin(angle7) * 143;
    var y7 = Math.cos(angle7) * 143;
    var x8 = Math.sin(angle8) * 287;
    var y8 = Math.cos(angle8) * 287;
    var x9 = Math.sin(angle8) * 450;
    var y9 = Math.cos(angle8) * 450;
        
    
    translate(width / 2, height / 2 + 100);
    noStroke();
    //rotate(angle);
//        x = this.player.x + (Math.cos(this.player.rotation + 0.85) * length);
//        y = this.player.y + (Math.sin(this.player.rotation + 0.85) * length) ;
    fill(255, 162, 15);
    ellipse(0,0,700 * slider.value(),700 * slider.value());
    
    //rotate(angle2);
    fill(139, 133, 99);
    ellipse(x2,y2,2.4 * slider.value(),2.4 * slider.value());
    
    //rotate(angle3);
    fill(186, 171, 84);
    ellipse(x3,y3,6 * slider.value(),6 * slider.value());
    
    //rotate(angle4);
    fill(40, 178, 203);
    ellipse(x4,y4,6.3 * slider.value(),6.3 * slider.value());
    
    //rotate(angle5);
    fill(159, 48, 28);
    ellipse(x5,y5,3.3 * slider.value(),3.3 * slider.value());
    
    //rotate(angle6);
    //rgb(242, 152, 8);
    fill(157, 92, 45);
    ellipse(x6,y6,69 * slider.value(),69 * slider.value());
//    fill(255, 0, 0);
//    ellipse(78,-30,69 * slider.value(),69 * slider.value());
    
    
    //rotate(angle7);
    stroke(180, 169, 132); 
    //strokeWeight(14);
    fill(0, 0, 0, 0);
    ellipse(x7,y7,125 * slider.value(),120 * slider.value());
    ellipse(x7,y7,110 * slider.value(),105 * slider.value());
    ellipse(x7,y7,90 * slider.value(),90 * slider.value());
    noStroke();
    fill(168, 150, 87);
    ellipse(x7,y7,58 * slider.value(),58 * slider.value());
    
    //rotate(angle8);
    fill(82, 159, 216);
    ellipse(x8,y8,25 * slider.value(),25 * slider.value());
    
    //rotate(angle9);
    fill(33, 84, 199);
    ellipse(x9,y9,24 * slider.value(),24 * slider.value());
    
    fill(0,0,0,0);
    stroke(189, 225, 255);
    //strokeWeight(1);
    triangle(x2,y2 - 5,x2 + 15,y2 - 25,x2 - 15,y2 - 25);
    text("Mercury",x2 - 20,y2 - 30);
    triangle(x3,y3 - 5,x3 + 15,y3 - 25,x3 - 15,y3 - 25);
    text("Venus",x3 - 20,y3 - 30);
    triangle(x4,y4 - 5,x4 + 15,y4 - 25,x4 - 15,y4 - 25);
    text("Earth",x4 - 20,y4 - 30);
    triangle(x5,y5 - 5,x5 + 15,y5 - 25,x5 - 15,y5 - 25);
    text("Mars",x5 - 20,y5 - 30);
    triangle(x6,y6 - 5,x6 + 15,y6 - 25,x6 - 15,y6 - 25);
    text("Jupiter",x6 - 20,y6 - 30);
    triangle(x7,y7 - 5,x7 + 15,y7 - 25,x7 - 15,y7 - 25);
    text("Saturn",x7 - 20,y7 - 30);
    triangle(x8,y8 - 5,x8 + 15,y8 - 25,x8 - 15,y8 - 25);
    text("Uranus",x8 - 20,y8 - 30);
    triangle(x9,y9 - 5,x9 + 15,y9 - 25,x9 - 15,y9 - 25);
    text("Neptune",x9 - 20,y9 - 30);
    //textSize(18);
    text( "The size of the Sun and the planets:  X  " + Math.floor(slider.value() * 10000), -300, height / 2 - 150);
    text( "The speed of movement:  X  " + Math.floor(slider2.value() * 31536000), 0, height / 2 - 150);
    
    millisecond = millis();
    wave.freq(freqNote);
    if (iN === lenNotePlayer1.length && millisecond > timer && playing) {
          iN = 0;
          freqNote = midiToFreq(freqPlayer1[iN]-12);//freqArr[i][0];
          lengthNote = lenNotePlayer1[iN];//freqArr[i][1];
          if(freqPlayer1[iN] !== 0) {
            env.play();
          }
    timer = millisecond + lengthNote * 3;
          console.log(0);
          iN += 1;
        } else if (millisecond > timer && playing) {
          freqNote = midiToFreq(freqPlayer1[iN]-12);//freqArr[i][0];
          lengthNote = lenNotePlayer1[iN];//freqArr[i][1];
          if(freqPlayer1[iN] !== 0) {
            env.play();
          }
    timer = millisecond + lengthNote * 3;
          console.log(1);
          iN += 1;
        }
  }
  
    
</script>    
  </div>
</body>

</html>
